!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.vegaTooltip={})}(this,function(t){"use strict";var b=/("(?:[^\\"]|\\.)*")|[:,\][}{]/g;function e(t,n,e){return n in t?t[n]:e}var n=function(t,n){n=n||{};var h=JSON.stringify([1],null,e(n,"indent",2)).slice(2,-3),g=e(n,"margins",!1),v=""===h?1/0:e(n,"maxLength",80);return function r(l,t,n){l&&"function"==typeof l.toJSON&&(l=l.toJSON());var e=JSON.stringify(l);if(void 0===e)return e;var i,o,s=v-t.length-n;if(e.length<=s){var a=(o={"{":"{"+(i=g?" ":""),"[":"["+i,"}":i+"}","]":i+"]",",":", ",":":": "},e.replace(b,function(t,n){return n?t:o[t]}));if(a.length<=s)return a}if("object"==typeof l&&null!==l){var u,f=t+h,d=[],c=function(t,n){return n===t.length-1?0:1};if(Array.isArray(l)){for(var p=0;p<l.length;p++)d.push(r(l[p],f,c(l,p))||"null");u="[]"}else Object.keys(l).forEach(function(t,n,e){var i=JSON.stringify(t)+": ",o=r(l[t],f,i.length+c(e,n));void 0!==o&&d.push(i+o)}),u="{}";if(0<d.length)return[u[0],h+d.join(",\n"+f),u[1]].join("\n"+t)}return e}(t,"",0)};function i(t,n,e){return t.fields=n||[],t.fname=e,t}function f(t){throw Error(t)}var d=Array.isArray;function c(t){return t===Object(t)}function p(t){return"string"==typeof t}function o(t){return d(t)?"["+t.map(o)+"]":c(t)||p(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}var r,l,s,a,u=[],h=(s=function(t){var n,e,i,o=[],r=null,l=0,s=t.length,a="";function u(){o.push(a+t.substring(n,e)),a="",n=e+1}for(t+="",n=e=0;e<s;++e)if("\\"===(i=t[e]))a+=t.substring(n,e),n=++e;else if(i===r)u(),r=null,l=-1;else{if(r)continue;n===l&&'"'===i?(n=e+1,r=i):n===l&&"'"===i?(n=e+1,r=i):"."!==i||l?"["===i?(n<e&&u(),l=n=e+1):"]"===i&&(l||f("Access path missing open bracket: "+t),0<l&&u(),l=0,n=e+1):n<e?u():n=e+1}return l&&f("Access path missing closing bracket: "+t),r&&f("Access path missing closing quote: "+t),n<e&&(e++,u()),o}(r="id"),a="return _["+s.map(o).join("][")+"];",i(Function("_",a),[r=1===s.length?s[0]:r],l||r),i(function(t){return t},u,"identity"),i(function(){return 0},u,"zero"),i(function(){return 1},u,"one"),i(function(){return!0},u,"true"),i(function(){return!1},u,"false"),Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}),g=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)n.indexOf(i[o])<0&&(e[i[o]]=t[i[o]])}return e},v=n,y={offsetX:10,offsetY:10,id:"vg-tooltip-element",styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:x},m="\n.vg-tooltip {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0,0,0,0.1);\n\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n.vg-tooltip.visible {\n  visibility: visible;\n}\n.vg-tooltip h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n.vg-tooltip table {\n  border-spacing: 0;\n}\n.vg-tooltip td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n.vg-tooltip td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n.vg-tooltip td.value {\n  max-width: 200px;\n  text-align: left;\n}\n\n/* Dark and light color themes */\n.vg-tooltip.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n.vg-tooltip.dark-theme td.key {\n  color: #bfbfbf;\n}\n\n.vg-tooltip.light-theme {\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n.vg-tooltip.light-theme td.key {\n  color: #808080;\n}\n";function x(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")}var O=function(){function t(t){if(this.options=h({},y,t),this.call=this.handler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var n=document.createElement("style");n.setAttribute("id",this.options.styleId),n.innerHTML=m,document.querySelector("head").appendChild(n)}var e=document.getElementById(this.options.id);e?this.el=e:(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.querySelector("body").appendChild(this.el))}return t.prototype.handler=function(t,n,e,i){if(void 0!==n.vegaType){this.el.innerHTML=this.formatValue(i),this.el.classList.add("visible",this.options.theme+"-theme");var o=this.el.getBoundingClientRect().width,r=n.clientX+this.options.offsetX;r+o>window.innerWidth&&(r=n.clientX-this.options.offsetX-o);var l=this.el.getBoundingClientRect().height,s=n.clientY+this.options.offsetY;s+l>window.innerHeight&&(s=+n.clientY-this.options.offsetY-l),this.el.setAttribute("style","top: "+s+"px; left: "+r+"px")}else this.el.classList.remove("visible",this.options.theme+"-theme")},t.prototype.formatValue=function(t){var n=this.options.sanitize;if(d(t))return"["+t.map(function(t){return n(p(t)?t:v(t))}).join(", ")+"]";if(c(t)){var e="",i=t,o=i.title,r=g(i,["title"]);o&&(e+="<h2>"+o+"</h2>"),e+="<table>";for(var l=0,s=Object.keys(r);l<s.length;l++){var a=s[l],u=r[a];c(u)&&(u=v(u)),e+='<tr><td class="key">'+n(a)+':</td><td class="value">'+n(u)+"</td></tr>"}return e+="</table>"}return n(String(t))},t}();t.DEFAULT_OPTIONS=y,t.escapeHTML=x,t.Handler=O,t.default=function(t,n){var e=new O(n);return t.tooltip(e.call).hover().run(),e},Object.defineProperty(t,"__esModule",{value:!0})});